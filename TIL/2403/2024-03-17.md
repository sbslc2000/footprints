## WAR 배포의 단점
WAR 배포 방식은 다음과 같은 과정을 거쳐야 한다.
* 톰캣과 같은 웹 애플리케이션을 별도로 설치해야 함.
* 애플리케이션 코드를 WAR로 빌드해야 함.
* 빌드한 WAR 파일을 WAS에 배포해야함.

이는 다음과 같은 단점을 갖는다.
* WAS를 별도로 설치해야 한다.
* 개발 환경 설정이 복잡하다.
	* 단순한 자바라면 별도의 설정을 고민하지 않고, main 메서드만 실행하면 된다.
	* WAS를 실행해야하고, 이를 WAR와 연동하기 위한 복잡한 설정이 들어간다.
* 배포 과정이 복잡하다. 
* 톰캣의 버전을 변경하려면 톰캣을 다시 설치해야한다.

이러한 방식의 불편함은 느낀 개발자들은 이미 Java로 구현되어있는 Tomcat을 마치 하나의 라이브러리처럼 포함해서 사용하게 만들었다. 

## 내장 톰캣 - 설정 1
```groovy
dependencies {  
    //스프링 MVC 추가  
    implementation 'org.springframework:spring-webmvc:6.0.4'  
  
    //내장 톰켓 추가  
    implementation 'org.apache.tomcat.embed:tomcat-embed-core:10.1.5'  
}
```

## 내장 톰캣 - 서블릿
### main 메서드로 내장 톰캣 실행하기
```java
public class EmbedTomcatServletMain {  
  
    public static void main(String[] args) throws LifecycleException {  
        System.out.println("EmbedTomcatServletMain.main");  
  
        // 톰캣 설정  
        Tomcat tomcat = new Tomcat();  
  
        Connector connector = new Connector();  
        connector.setPort(8080);  
        tomcat.setConnector(connector);  
  
        // 서블릿 등록  
        Context ctx = tomcat.addContext("", "/");  
        tomcat.addServlet("", "helloServlet", new HelloServlet());  
  
        ctx.addServletMappingDecoded("/hello-servlet", "helloServlet");  
	    // 톰캣 시작
        tomcat.start();  
    }  
}
```

1. 톰캣 설정
	1. 내장 톰캣을 생성하고, 톰캣이 제공하는 커넥터를 사용하여 8080포트에 연결
2. 서블릿 등록
	1. 톰캣에 사용할 contextPath와 docBase를 지정함
	2. addServlet을 통해 서블릿을 등록
	3. addServletMappingDecoded로 서블릿의 경로를 매핑
3. 톰캣 시작
	1. tomcat.start()를 통해 톰캣을 시작

이를 통해 별도의 톰캣 설정없이 톰캣을 실행하는 방법을 해보았다.

## 내장 톰캣 3 - 스프링

```java
public static void main(String[] args) throws LifecycleException {  
    System.out.println("EmbedTomcatSpringMain.main");  
  
    // 톰캣 설정  
    Tomcat tomcat = new Tomcat();  
  
    Connector connector = new Connector();  
    connector.setPort(8080);  
    tomcat.setConnector(connector);  
  
    //스프링 컨테이너 생성  
    AnnotationConfigWebApplicationContext appContext = new AnnotationConfigWebApplicationContext();  
    appContext.register(HelloConfig.class);  
  
    //스프링 MVC 디스패처 서블릿 생성, 스프링 컨테이너 연결  
    DispatcherServlet dispatcher = new DispatcherServlet(appContext);  
  
    // 디스패처 서블릿 등록  
    Context context = tomcat.addContext("", "/");  
    tomcat.addServlet("", "dispatcher", dispatcher);  
    context.addServletMappingDecoded("/", "dispatcher");  
  
  
    tomcat.start();  
}
```

* 스프링 컨테이너를 만들고 필요한 빈 등록
* 스프링 MVC 디스패처 서블릿 생성 후 스프링 컨테이너와 연결
* 디스패처 서블릿을 내장 톰캣에 등록

