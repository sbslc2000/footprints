---
상위 개념: "[[../../../../Language/Java/JDBC/Connenction|Connenction]]"
---
# SYN Flood Attack
TCP에서 서버는 클라이언트로부터 SYN을 수신하면 연결 변수와 버퍼를 할당하고, SYNACK을 전송한 뒤 클라이언트의 ACK를 기다린다. 만약 클라이언트가 ACK를 보내지 않으면 일정 시간이 지난 후 반쯤 열린 연결을 종료하고 자원을 회수한다.

이러한 구조는 SYN flood라는 서비스 거부 공격의 대상이 될 수 있다. 공격자는 3-way 핸드셰이크를 의도적으로 미완성 상태로 남겨놓는 다수의 SYN 세그먼트를 보내 서버의 연결 자원을 소진시키고 정상 클라이언트의 연결을 방해한다.

이 문제를 해결하기 위해 SYN cookies 기법이 도입되었다. 이 방식에서 서버는 SYN을 수신해도 연결 자원을 바로 할당하지 않고, 초기 시퀀스 번호를 특별한 방식으로 생성한다. 이 번호는 SYN 패킷의 IP 주소와 포트 번호, 그리고 서버만 알고 있는 비밀값을 조합하여 해시로 계산한 값이다. 서버는 이 값을 시퀀스 번호로 사용해 SYNACK을 전송하고, 이후 해당 상태를 메모리에 유지하지 않는다.

정상적인 클라이언트가 ACK를 보내오면, 서버는 해당 ACK의 acknowledgment 값을 통해 이전 SYN의 유효성을 검증할 수 있다. 해시 계산을 통해 cookie 값을 재생성하고 비교하여 유효성이 확인되면 이때 비로소 자원을 할당하고 연결을 완성한다. 반면 클라이언트가 ACK를 보내지 않는다면 서버는 자원을 소모하지 않으므로 공격으로부터 보호된다.