---
상위 개념: "[[IP]]"
---
# NAT 
네트워크 주소 변환(NAT, Network Address Translation)은 SOHO(small office, home office) 네트워크에서 > 사설 IP를 사용하는 내부 장치들이 하나의 공인 IP를 통해 외부와 통신할 수 있게 해주는 주소 변환 기술이다.

\[RFC 2663, RFC 3022, Huston 2004, Zhang 2007]에 내용이 명시되어있다.

## 동작 원리
![](https://i.imgur.com/n4S1BFq.png)

위 그림의 오른쪽 부분의 네트워크는 여러 기기들과 라우터로 구성되어있다. 여기서 라우터는 NAT을 수행할 수 있으며, 이러한 라우터를 NAT 가능 라우터(NAT-enabled router)라고 한다. 이들은 모두 10.0.0.0/24의 네트워크 주소를 갖는다.

주소 공간 10.0.0.0/8은 사설망(private network) 또는 그림 4.25의 홈 네트워크와 같은 사설 개인 주소를 갖는 권역(realm)을 위해 \[RFC 1918]에서 예약된 IP 주소 공간이다. 이들 주소는 오직 해당 망 내부의 장비에만 의미가 있으며, 망 외부에서 사용될 수 없다. 이들 주소는 다른 홈 네트워크에서 동일한 주소공간을 사용하고 있기 때문이다. 그러나 홈 내부의 장비들 간에는 사설 IP 주소를 통해 서로 패킷을 송신할 수 있다.

홈 외부로 패킷을 보낼 때에는 네트워크 주소 변환이 실행되어야 한다. 호스트 10.0.0.1의 3345 포트에서 128.119.40.186의 80번 포트로 패킷을 보낸다고 가정해보자. 이 때 라우터는 패킷의 출발지 주소를 라우터의 WAN 사이드 주소(예시에서는 138.76.29.7)로 변경하며, 출발지 포트를 임의로 설정한다(예시에서는 5001). 이 정보는 NAT 변환 테이블에 기록된다.

이 패킷을 받은 웹서버는 출발지인 138.76.28.7의 5001 포트로 응답을 전송하며, 이는 라우터가 받는다. 라우터는 수신한 패킷의 정보를 확인하여 테이블에 매칭되는 홈 네트워크의 주소와 포트로 패킷을 재작성한 뒤 홈 네트워크로 데이터그램을 전달한다.

## 장점
여러 호스트가 하나의 IP 주소를 공유하게 만들어 빈번한 장비 교체나 확장에도 IP 주소 블록을 재할당 받을 필요가 없다. 이는 IP 고갈 문제 역시 해결한다.

## 단점
홈 네트워크에서 실행되는 서버는 요청을 받기 위해 특별한 기술을 사용해야 한다. NAT은 홈 네트워크에서 나갔다 들어오는 패킷에 대해서는 변환을 지원하지만, 외부에서 먼저 패킷이 들어오는 경우 홈 네트워크의 어떤 장비에 전달할지 알 수 없다.


