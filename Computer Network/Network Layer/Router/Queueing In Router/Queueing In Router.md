---
상위 개념: "[[Router]]"
---
# Queueing In Router
트래픽 발생, 스위치 구조의 상대 속도 및 라인 속도에 따라 입력 포트 큐 혹은 출력 포트 큐에 버퍼가 가득 찰 수 있다. 이 경우 패킷 손실이 발생한다.

## 입력 큐잉
만약 입력 링크로부터 도착하는 패킷을 전송하기에 스위치 구조가 충분히 빠르지 않다면 입력 큐의 길이가 증가하고 결국엔 패킷 손실이 발생할 수 있다.
![](https://i.imgur.com/79Eqsv6.png)
Interconnection Network를 사용한다면 서로 다른 입력 포트에서 서로 다른 출력 포트로 패킷을 전송할 수 있다. 하지만 동일한 출력 포트로 패킷을 전송해야 하는 경우 한 패킷은 차단되고 입력 큐에서 기다려야 한다.

두번째 그림에서 1번 입력 포트가 1번 출력 포트를 사용한다고 하자. 이 때 3번 입력 포트에서는 1번 출력 포트로 패킷을 전송하지 못하고 기다린다. 이 때 3번 입력 포트에서 기다리고 있는 두번째 패킷은 3번 출력 포트로 보내져야 한다. 3번 출력 포트는 경쟁이 없는 상태이지만 해당 패킷은 바로 앞의 패킷이 1번 출력포트를 기다리기에 함께 기다려야 한다. 이 현상은 입력 대기 중인 스위치에서의 **HOL(head-of-the-lin) 차단(블로킹)**이라고 한다.

Karol의 연구에서 입력 링크에서 패킷 도착 속도가 용량의 58%가 되면 HOL 차단 때문에 입력 큐가 무한정 길이로 증가한다고 한다.

## 출력 큐잉
![](https://i.imgur.com/PsWgCq6.png)

N개의 입력 포트가 있고, 스위치 구조의 전송 속도는 입력 링크 용량의 N배라고 하자. 이 경우, 출력 링크에 단일 패킷을 보내는데 걸리는 시간에 N개의 새로운 패킷이 출력 포트에 도착한다. 이것이 반복되면 대기 중인 패킷의 수가 버퍼를 꽉 채울 수도 있게 된다.

들어오는 패킷을 저장할 메모리가 충분하지 않을 때, 도착한 패킷을 삭제(drop-tail)하거나 아니면 대기중인 하나 이상의 패킷을 제거하여 새로 도착한 패킷을 저장하기 위한 공간을 확보해야한다. 이러한 알고리즘을 AQM(Active Queue Management)라고 하며 가장 폭넓게 연구되고 구현된 알고리즘 중 하나는 [[RED]](Random Early Detection)이다.
