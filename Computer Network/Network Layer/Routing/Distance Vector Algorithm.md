---
상위 개념: "[[Routing Algorithm]]"
---
# Distance Vector Algorithm
거리 벡터 알고리즘(Distance Vector Algorithm, DV)는 분산 라우팅 알고리즘 중 하나이다. 분산적(distributed)이고, 반복적(iterative)이며, 비동기적(asynchronous)인 특징을 갖는다.

* 분산적 : 각 노드는 하나 이상의 직접 연결된 이웃으로부터 정보를 받고, 계산을 수행하며, 계산된 결과를 다시 그 이웃들에게 배포한다.
* 반복적: 이웃기리 더 이상 정보를 교환하지 않을 때까지 프로세스가 지속된다.
* 비동기적: 톱니바퀴 돌듯이 모든 노드가 서로 정확히 맞물려 동작할 필요가 없다.

## 핵심 원리
![](https://i.imgur.com/YPqw8Fz.png)

DV 알고리즘은 최소 비용 경로의 비용들 사이의 중요한 관계식을 사용한다. 이는 벨만-포드(Bellman-Ford) 식이라고도 불린다.

$$ d_x(y) = min_v\{c(x,v) + d_v(y)\}$$

여기서 $min_v$는 x의 모든 이웃에 적용된다. DV 알고리즘의 핵심은 각 노드가 자신으로부터 다른 모든 목적지까지의 최단 경로 비용을 계산하고, 그 정보를 이웃들과 주기적으로 교환함으로써 전체 네트워크의 경로 정보를 점진적으로 완성해 나간다는 것이다. 초기에는 각 노드가 자신에게 인접한 노드에 대해서만 직접 연결된 거리 정보를 알고 있으며, 나머지 목적지에 대한 거리는 무한대로 시작된다. 이후 이웃 노드들로부터 받은 거리 벡터 정보를 이용하여 자신의 거리 벡터를 업데이트하고, 변화가 있을 경우 이를 다시 이웃들에게 전달하는 과정을 반복한다. 이는 더 이상의 갱신 메시지가 없을 때 까지 반복된다.

## Infinity Route
![](https://i.imgur.com/rM5OMQ5.png)
위 네트워크에서 최초의 거리 벡터는 다음과 같다.

|     | x   | y   | z   |
| --- | --- | --- | --- |
| x   | 0   | 4   | 5   |
| y   | 4   | 0   | 1   |
| z   | 5   | 1   | 0   |
y가 먼저 링크 비용 변화를 감지하였고, x까지의 새로운 최소 비용 경로를 계산한다고 하자.

$$ D_y(x) = min \{ c(y,x) + D_x(x), c(y,z) + D_z(x)\} = min{60 + 0, 1 + 5} = 6$$
네트워크 전체를 볼 수 있는 우리는 이 비용이 잘못되었다는 것을 안다. 하지만 노드 y가 가진 유일한 정보는 x까지 직접 가는 비용이 60이고, z는 x에 5의 비용으로 도착하는 방법을 알고 있다는 것이다. y는 z가 x에 패킷을 5의 비용으로 보내줄 것이라 기대하고 x로 가기위한 다음 노드로 설정한다.

이 순간에 x로 데이터를 보내기 위해 y는 z로 보내고 z는 y로 보내는 라우팅 루프(routing loop)가 발생한다. 이 시점에서는 x를 목적지로 하는 패킷이 y나 z에 도착하면 이 두 노드 사이에서 순환할 것이다.

|     | x     | y   | z   |
| --- | ----- | --- | --- |
| x   | 0     | 4   | 5   |
| y   | **6** | 0   | 1   |
| z   | 5     | 1   | 0   |
 
이 문제와 별개로 y는 $D_y(x)$를 6으로 업데이트할 것이고, 이는 이웃 노드에게 전파된다. 이 전파는 어떤 영향을 끼칠까? 이 정보를 받은 z는 x로 보내는 비용을 다시 계산한다. $min\{50 + 0, 1 + 6\}$ = 7. 따라서 $D_z(x)$는 7로 설정된다. 

|     | x     | y   | z   |
| --- | ----- | --- | --- |
| x   | 0     | 4   | 5   |
| y   | **6** | 0   | 1   |
| z   | **7** | 1   | 0   |

비슷한 방법으로 z의 새로운 거리 벡터를 수신한 후, $D_y(x)$는 8이 될 것이며, 이는 $D_z(x)$가 9가 되는 것을 초래한다. 이는 계속 반복되다가, $D_y(x)$가 50이 되는 경우 $min\{50 + 0, 1 + 50\}$이 되어 종료된다. 이 때 z는 마침내 x와의 직접 연결을 x로의 최소 비용 경로로 결정한다. 링크 비용의 증가라는 나쁜 소식은 정말 천천히 알려진다. 이러한 문제를 **무한 계수 문제**(count-to-infinity)라고 한다.