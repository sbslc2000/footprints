---
상위 개념: "[[Deadlock in Concurrency Control]]"
---
# Deadlock Recovery in Concurrency Control
교착 상태를 감지했다면 하나 이상의 트랜잭션을 롤백함으로써 교착 상태로부터 시스템을 복구해야한다.

## 희생자 선택
어떤 트랜잭션을 희생시킬 것인가? 가능한 최소의 비용이 드는 트랜잭션을 롤백하는 것이 좋겠지만, 최소 비용을 정확하게 계산하는 것은 어려운 일이다. 다음 요인들은 롤백 비용을 결정하는데에 사용할 수 있다.

1. 트랜잭션이 얼마나 오래 실행되었는가?
2. 작업을 끝마칠 때까지 얼마나 많은 연산이 남았는가?
3. 트랜잭션이 사용한 데이터 항목이 얼마나 많은가?
4. 작업을 마칠 때 까지 얼마나 더 많은 데이터 항목을 필요로 하는가?
5. 얼마나 많은 트랜잭션을 롤백해야 하는가?

## 롤백
희생 트랜잭션을 선택했다면 가장 간단하게는 트랜잭션을 전체 롤백(total rollback) 시킬 수 있다. 하지만 전체 롤백 대신 교착 상태를 풀 수 있을 정도로만 롤백한다면 좀 더 효율적일 것이다. 이를 부분 롤백(partial rollback)이라고 한다.

부분 롤백을 하기 위해서는 시스템이 현재 수행중인 모든 트랜잭션에 관한 정보를 추가로 가지고 있어야 한다. (e.g., 잠금 요청 및 할당 순서, 트랜잭션이 수행한 갱신 기록). 희생자에 대한 정보를 토대로 희생자의 스케줄을 교착 상태가 발생한 잠금 요청 이전 상태로 되돌리고, 갱신 기록들도 초기화함으로써 부분 롤백을 수행할 수 있다.

## 기아
비용 요인에 따라 희생자를 선택하는 경우 같은 희생이 반복될 수 있다. 그러므로 희생자로 선택되는 횟수를 제한할 필요가 있는데, 가장 일반적인 해결책은 비용 측정에 롤백 횟수를 포함시키는 것이다.