---
상위 개념: "[[../Lock Protocol|Lock Protocol]]"
---
# Multiple-granularity Locking Protocol
다중 세분도 잠금 규약(multiple-granularity locking protocol, MGL)은 데이터 항목에 대한 잠금을 시행하는 데 여러 단계의 세분도를 제공하는 잠금 규약 방식이다.

개별 데이터 항목을 잠금의 단위로 사용하면 대량의 레코드에 대한 잠금을 걸어야 하는 경우 너무 오랜 시간이 걸릴 수도 있고, 최악의 경우 잠금 테이블이 너무 커져 메모리의 크기를 초과할 수도 있다. 만약 잠금의 단위를 유연하게 만들어 하나의 잠금으로 데이터베이스나 릴레이션에 잠금을 걸 수 있다면 효과적일 것이다. 다중 세분도 잠금 규약은 이러한 이유로 잠금 단위에 여러 단계의 세분도를 제공한다.

## 동작 원리
데이터 항목들은 트리 형태로 표현된다.
![](https://i.imgur.com/ZAzuuu6.png)
여기서 $A_n$은 데이터베이스, $F_n$은 릴레이션, $r_{n_k}$는 레코드로 볼 수 있다. 만약 $F_b$에 공유 잠금을 걸면, $r_{b_k}$에는 암시적인 공유 잠금이 걸린다.

만약 $T_j$가 $F_b$에 대한 독점 잠금을 얻고 싶다면, 루트 노드로부터 $F_b$까지 노드를 조사하며 다른 트랜잭션으로부터 독점 혹은 공유 잠금이 걸렸는지 확인해야 한다. 모든 부모 노드가 잠금이 없을 때에 $T_j$는 $F_b$에 독점 잠금을 얻을 수 있다. 반면 공유 잠금을 얻고자 할 때에는, 부모 노드에 공유 잠금이 걸려있는 것은 허용할 것이다.

## Intention Lock Mode