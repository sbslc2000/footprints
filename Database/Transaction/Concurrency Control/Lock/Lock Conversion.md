---
상위 개념: "[[Lock]]"
---
# Lock Conversion
![](https://i.imgur.com/euQ83tZ.png)
2단계 잠금 규약을 적용할 때, $T_8$의 $a_1$에 대해 반드시 독점적 모드의 잠금을 걸어야 직렬 가능한 실행을 보장할 수 있다. 하지만 $T_8$은 $a_1$을 갱신하는 마지막 연산에서만 $a_1$에 대한 독점적 잠금을 필요로 한다. 

만약 $a_1$을 얻는 시점에 공유 모드로 잠금을 걸었다가 나중에 독점적 모드로 잠금을 변경한다면 더 나은 동시성을 얻을 수 있을 것이다. 실제로 트랜잭션은 잠금을 얻는 과정에서 특정 데이터에 대해 공유 잠금을 독점적 잠금으로 변경 할 수 있는 매커니즘이 있으며, 이를 잠금 변환(Lock Conversion)이라고 한다.

구체적으로는 upgrade 명령문을 통해 공유 잠금을 독점적 잠금으로 올릴 수 있으며, downgrade 명령문을 통해 독점적 잠금을 공유 잠금으로 낮출 수 있다.

하지만 잠금 변환은 언제든지 가능한 것은 아니다. upgrade 명령은 증가 단계에서만 가능하고 downgrade 명령은 감소 단계에서만 가능하다. 더 정확히는, 각각에 단계에서 수행되어야만 직렬 가능성을 보장할 수 있다.