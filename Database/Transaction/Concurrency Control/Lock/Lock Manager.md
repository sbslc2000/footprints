---
상위 개념: "[[Lock]]"
---
# Lock Manager
잠금 관리자(Lock Manager)는 트랜잭션의 잠금을 관리해주는 주체이다. 트랜잭션으로부터 요청 메시지를 받고 다시 응답 메시지를 트랜잭션에 보내는 방법으로 구현된다.

잠금 관리자는 잠금 요청 메시지에 대해 잠금 허용 메시지(grant message)로 응답하거나, 아니면 트랜잭션의 취소를 요청하는 메시지(교착 상태의 경우)로 응답한다.

잠금 해제 메시지는 응답으로 승인 메시지(acknowledgement)만 요구하며, 동시에 잠금 관리자는 다른 대기 상태 트랜잭션에 잠금 허용 메시지를 보낼 수도 있다.

잠금 관리자는 잠금을 관리하기 위해서 잠금 테이블(Lock Table)을 사용한다.

트랜잭션으로부터 잠금 요청이 들어오면 잠금 관리자는 먼저 해당 데이터 항목에 잠금이 있는지를 검사하며, 만약 없다면 잠금 테이블에 정보를 기입하고 해당 트랜잭션에게 허용 메시지를 전달한다. 만약 이미 다른 트랜잭션이 잠금을 가지고 있다면, 연결 리스트의 뒤에 해당 요청을 저장한다. 만약 현재 걸려있는 잠금과 호환되고, 모든 이전 잠금 요청이 이미 허용되어 있을 때 잠금을 허용할 수 있다. 만약 그렇지 않다면 허용할 수 있을 때 까지 트랜잭션은 대기해야한다.

또한 특정 트랜잭션이 실패하거나 종료될 때 잠금 관리자는 해당 트랜잭션이 보유한 모든 잠금을 취소하고, 그로 인해 발생한 변경에 대해 새롭게 다른 트랜잭션들에 잠금을 허용해주어야 한다. 이를 위해 잠금 관리자는 잠금 테이블에 대해 특정 트랜잭션 식별자에 대한 인덱스를 유지해야 효율적으로 작업을 수행할 수 있다.
