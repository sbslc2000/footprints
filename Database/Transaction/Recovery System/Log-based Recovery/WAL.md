---
상위 개념: "[[Log-based Recovery]]"
---
## **Write-Ahead Logging (WAL) 원칙**
쓰기 전 로깅 원칙(WAL) 다음 두 가지 규칙을 따른다
1. **UNDO 보장:**
    트랜잭션이 데이터 페이지를 변경하기 전에 해당 변경 사항을 Undo 가능하도록 로그에 먼저 기록한다.
2. **REDO 보장:**
    트랜잭션이 커밋될 때, 커밋 로그 레코드가 디스크에 기록되기 전까지는 해당 트랜잭션이 커밋되었다고 간주하지 않는다.
    
### WAL Write Protocol
WAL(Write-Ahead Logging) 원칙을 실제 시스템에서 안전하게 구현하기 위해 데이터베이스는 다음과 같은 절차를 따른다:

1. 데이터 블록을 디스크로 flush하기 전 해당 블록에 대한 배타적 latch를 획득한다.
2. 해당 블록이 더 이상 수정 중이지 않음을 확인한다.
3. 해당 블록에 대한 undo log가 안정 저장 장치의 로그에 먼저 기록되었는지 확인하고, 필요 시 log flush를 수행한다.
4. 그 이후에만 데이터 블록을 디스크에 기록한다.
5. 기록이 완료되면 latch를 해제한다.