---
상위 개념: "[[Recovery System]]"
---
# Stable Storage
안정 저장 장치(Stable Storage)란 물리적인 저장 장치에서 발생할 수 있는 모든 종류의 실패에도 불구하고, 저장된 정보가 손실되지 않는 것을 보장하는 이상적인 저장 장치의 추상화 모델이다.

안정 저장 장치를 지향하여 구현된 장치는 필요한 정보를 여러 비휘발성 저장 매체에 복사하며, 데이터 전송의 실패로 인해 필요한 정보가 손상된 상태로 저장장치에 저장되지 않도록 통제된 방법으로 데이터를 갱신해야한다.

## Data-Transfer Failure
메모리와 디스크 저장 장치 사이의 블록 전송으로 인해 발생하는 결과는 다음과 같다.

* 성공적인 완료(Successful Completion)
* 부분 실패(Partial Fail) : 전송 중에 실패가 발생하여 목적지 블록이 정확하지 않은 정보를 갖게된 경우
* 완전 실패(Total Failure) : 전송 초기에 실패가 발생하여 목적지의 블록이 전혀 갱신되지 않은 경우

데이터 전송 실패가 발생하면 시스템은 이를 탐지하고 복구 절차를 수행하여 블록을 일관성 있는 상태로 되돌려야 한다. 이를 위해 시스템은 각 논리적 데이터베이스 블록에 대해 두 개의 물리적 블록을 유지한다. 블록 쓰기 연산을 다음과 같이 실행한다.

1. 정보를 첫 번째 물리 블록에 기록한다.
2. 첫 번째 쓰기 연산이 성공적으로 끝나면, 같은 정보를 두 번째 물리 블록에 기록한다.
3. 두 번째 쓰기 연산을 성공적으로 완료했을 때만 블록 쓰기 연산이 완료 된다.

블록을 쓰는 도중 시스템 장애가 발생하면 두 블록의 내용이 일치하지 않는 상황이 발생할 수 있다. 따라서 복구 시에는 각 블록에 대해, 두 개의 블록 사본 모두를 검사해야한다.

1. 만약 두 블록 사본이 서로 같고 발견된 오류가 없다면, 더 필요한 조치는 없다. (오류는 체크섬으로 검사한다.)
2. 만약 두 블록 사본 중 하나에 오류가 있다는 것을 발견하면, 시스템은 그 내용을 다른 블록 사본의 내용으로 대체한다.
3. 만일 두 블록 사본에 오류가 없는데도 서로 다른 내용을 가지고 있다면, 시스템은 둘 중 하나의 내용으로 다른 블록 사본의 값을 변경한다.
