---
상위 개념: "[[B+Tree Index/B+Tree Index]]"
---
# B+Tree Index Bulk Loading
많은 수의 엔트리를 한 번에 인덱스에 삽입하는 것을 인덱스의 벌크 로딩이라고 한다.

## 벌크로딩이 필요한 이유
대용량의 릴레이션에 B+트리 인덱스를 구축할 때, 데이터가 임의의 순서로 저장된다면 최악의 경우 매 삽입 마다 각기 다른 단말 노드를 메모리에 불러와야하고, 이 때 버퍼에 해당 노드가 없다면 매번 디스크 탐색을 수행해야한다. 최악의 경우 인덱스의 엔트리 개수 만큼의 랜덤 I/O가 발생할 수 있으며, 각 I/O 연산이 10ms가 걸린다고 가정할 때 1억개의 레코드의 인덱스를 만들기 위해서는 백만 초가 걸린다.

## 정렬 후 삽입
엔트리가 정렬된 순서로 삽입된다면, 특정 단말 노드에 들어갈 모든 엔트리는 연속적으로 나타날 것이고 단말 노드는 한 번만 작성된다. 모든 삽입 과정에서 각 단말 노드는 오직 한 번의 I/O 연산만을 요구한다.

## 상향식 B+Tree 구축
만약 B+트리가 초기에 비어 있는 상태라면 일반적인 삽입 프로시저를 사용하는 대신 단말 노드 계층부터 위로 내부노드를 역방향으로 구축해나간다면 더 빠르게 만들 수 있다. 정렬된 레코드들을 노드가 수용할 수 있는 최대 개수로 나누어 이들을 각각 단말 노드로 구성한다. 이렇게 생성된 단말노드를 연결하는 내부노드를 생성하며, 이를 루트노드가 될 때까지 반복한다. 각 단말 노드의 엔트리 개수를 최대한 채우게 구축되므로 막 구축되고나서의 B+트리는 최소의 높이를 갖는다.


