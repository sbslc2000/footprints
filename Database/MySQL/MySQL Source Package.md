---
상위 링크: "[[MySQL]]"
---
MySQL의 소스 코드를 분석하고 스터디할 때, MySQL의 아키텍처를 이해하는 것은 매우 중요합니다. MySQL은 다양한 모듈로 구성된 복잡한 시스템이며, 각 모듈은 특정 기능을 수행하는 역할을 가지고 있습니다. MySQL 소스 코드의 구조를 이해하고 패키지별 역할을 파악하는 것이 효율적인 학습의 시작입니다. 아래는 MySQL 소스 코드 디렉토리 구조와 각 패키지의 주요 기능을 설명하는 가이드라인입니다.

### MySQL 소스 코드 디렉토리 구조
MySQL 소스 코드는 일반적으로 다음과 같은 디렉토리 구조를 가집니다:

```
mysql-server/
├── client/
├── cmake/
├── cmd-line-utils/
├── components/
├── configure.cmake
├── docs/
├── extra/
├── include/
├── libbinlogevents/
├── libmysql/
├── mysql-test/
├── mysys/
├── plugin/
├── scripts/
├── sql/
├── sql-common/
├── storage/
├── strings/
├── support-files/
├── unittest/
└── vio/
```

각 디렉토리의 주요 역할과 학습 시 중요 포인트는 다음과 같습니다.

### 1. **client/**
- **설명**: MySQL 클라이언트 유틸리티와 관련된 소스 코드가 포함되어 있습니다. `mysql` CLI, `mysqladmin`, `mysqlshow` 등의 명령줄 도구들이 여기서 구현됩니다.
- **학습 포인트**:
  - MySQL 클라이언트와 서버 간의 통신 방식.
  - 클라이언트 명령어 처리 로직 분석.
  
### 2. **cmake/**
- **설명**: MySQL 빌드 시스템을 관리하는 CMake 관련 스크립트가 포함되어 있습니다. MySQL의 컴파일, 링크, 빌드 옵션 등이 설정됩니다.
- **학습 포인트**:
  - MySQL 컴파일 시 빌드 옵션을 변경하거나 새로운 기능을 추가할 때.
  - 빌드 시스템의 구조와 옵션 이해.

### 3. **components/**
- **설명**: MySQL 서버에 로드할 수 있는 독립적인 컴포넌트가 포함됩니다. 컴포넌트 기반의 아키텍처를 지원하며, MySQL 8.0부터 추가된 기능입니다.
- **학습 포인트**:
  - 컴포넌트 기반 아키텍처와 플러그인 구조 이해.
  - 커스텀 컴포넌트 개발 방법.

### 4. **include/**
- **설명**: MySQL의 전역 헤더 파일들이 포함된 디렉토리로, 공통적으로 사용되는 구조체, 상수, 매크로 등이 정의되어 있습니다.
- **학습 포인트**:
  - 전역적인 상수, 매크로, 데이터 타입 정의 파악.
  - MySQL의 전반적인 코드베이스 이해.

### 5. **libmysql/**
- **설명**: MySQL 클라이언트 라이브러리로, 애플리케이션에서 MySQL 서버와 통신하기 위한 C API가 구현되어 있습니다.
- **학습 포인트**:
  - MySQL 클라이언트 라이브러리와 API 사용 방법.
  - 서버와의 통신 프로토콜 이해.

### 6. **mysys/**
- **설명**: MySQL의 시스템 레벨의 유틸리티 함수들과 플랫폼 독립적인 코드가 포함되어 있습니다. 스레드 관리, 파일 입출력, 메모리 관리 등의 함수가 정의됩니다.
- **학습 포인트**:
  - 플랫폼 독립적인 시스템 호출 및 유틸리티 함수 이해.
  - 스레드 및 메모리 관리.

### 7. **plugin/**
- **설명**: 다양한 MySQL 플러그인들이 포함된 디렉토리입니다. 인증 플러그인, 복제 관련 플러그인, Full-text 검색 플러그인 등 MySQL의 확장 기능들이 포함되어 있습니다.
- **학습 포인트**:
  - MySQL 플러그인 인터페이스 이해.
  - 새로운 플러그인 개발 및 기존 플러그인 분석.

### 8. **sql/**
- **설명**: MySQL의 핵심 SQL 엔진이 구현된 디렉토리입니다. SQL 파서, 쿼리 최적화기, 실행 계획 생성, 트랜잭션 관리 등 주요 기능들이 포함되어 있습니다.
- **학습 포인트**:


MySQL의 `sql` 디렉토리는 MySQL 서버의 핵심 기능이 구현된 곳으로, SQL 파서, 쿼리 최적화, 트랜잭션 관리, 스토리지 엔진 인터페이스 등 MySQL 서버의 주요 로직이 포함되어 있습니다. `sql` 디렉토리 내부의 패키지 구조를 이해하면 MySQL의 전체적인 아키텍처와 내부 동작 방식을 파악하는 데 도움이 됩니다. 아래는 `sql` 디렉토리의 주요 파일과 서브 디렉토리, 그리고 각 파일이 담당하는 역할에 대한 설명입니다.

### `sql` 디렉토리 구조와 주요 구성 요소

```
sql/
├── auth/
├── binlog/
├── dd/
├── gis/
├── handler/
├── item/
├── optimizer/
├── partition/
├── repl/
├── rpl_log/
├── sql_yacc.yy
├── table/
├── threads/
├── transaction/
├── CMakeLists.txt
├── mysqld.cc
└── ...
```

### 주요 디렉토리 및 파일 설명

#### 1. **`auth/`**
- **설명**: 사용자 인증과 권한 관리와 관련된 코드를 포함하고 있습니다. MySQL의 인증 플러그인, 권한 체크 로직 등이 여기에 구현되어 있습니다.
- **주요 파일**:
  - `auth_common.cc`: 일반적인 인증 로직.
  - `sql_auth_cache.cc`: 인증 캐시 관련 로직.
  - `sql_authentication.cc`: 인증 메커니즘 구현.
- **학습 포인트**:
  - MySQL의 사용자 인증과 권한 관리 메커니즘.
  - 사용자 인증 플러그인의 동작 방식.

#### 2. **`binlog/`**
- **설명**: 바이너리 로그와 관련된 기능이 포함되어 있습니다. 바이너리 로그는 복제와 데이터 복구에 사용됩니다.
- **주요 파일**:
  - `binlog.cc`: 바이너리 로그의 기록 및 읽기 로직.
  - `binlog_event.cc`: 바이너리 로그 이벤트 처리.
  - `binlog_storage.cc`: 바이너리 로그 스토리지 관리.
- **학습 포인트**:
  - 바이너리 로그의 구조와 저장 방식.
  - 복제 시 바이너리 로그의 역할.

#### 3. **`dd/`**
- **설명**: Data Dictionary 관련 코드가 포함된 디렉토리입니다. 데이터 사전은 MySQL 8.0에서 도입된 메타데이터 관리 시스템입니다.
- **주요 파일 및 서브 디렉토리**:
  - `dd.cc`: 데이터 사전 초기화 및 관리.
  - `dd_table.cc`: 테이블 메타데이터 처리.
  - `dd/types/`: 테이블, 컬럼, 인덱스 등 다양한 데이터 사전 엔티티 타입 정의.
- **학습 포인트**:
  - MySQL 데이터 사전 구조 및 메타데이터 관리 방식.
  - 데이터베이스 객체의 메타데이터 관리 및 캐싱 로직.

#### 4. **`gis/`**
- **설명**: 지리 정보 시스템(GIS) 관련 기능이 포함되어 있습니다. MySQL의 공간 데이터 타입 및 연산자 구현이 여기에 있습니다.
- **주요 파일**:
  - `gis_geometry.cc`: GIS 기하학적 연산 구현.
  - `gis_internal.cc`: GIS 내부 연산 로직.
- **학습 포인트**:
  - MySQL의 공간 데이터 타입과 함수 구현.
  - 공간 인덱싱 및 검색 알고리즘.

#### 5. **`handler/`**
- **설명**: 스토리지 엔진 핸들러와 관련된 코드가 포함되어 있습니다. MySQL은 다양한 스토리지 엔진을 지원하며, 각 엔진의 인터페이스가 이 디렉토리에 정의되어 있습니다.
- **주요 파일**:
  - `handler.cc`: 스토리지 엔진 인터페이스의 기본 구현.
  - `ha_innodb.cc`: InnoDB 스토리지 엔진의 핸들러 구현.
  - `ha_partition.cc`: 파티션 스토리지 엔진 핸들러.
- **학습 포인트**:
  - MySQL의 스토리지 엔진 플러그인 구조.
  - 스토리지 엔진 간의 공통 인터페이스와 동작 방식.

#### 6. **`item/`**
- **설명**: SQL 표현식 및 함수 관련 코드가 포함되어 있습니다. 각 SQL 연산자와 내장 함수가 이 디렉토리에 정의되어 있습니다.
- **주요 파일**:
  - `item.cc`: 기본 표현식 클래스 정의.
  - `item_func.cc`: 다양한 내장 함수 구현.
  - `item_cmpfunc.cc`: 비교 함수 구현.
- **학습 포인트**:
  - SQL 표현식 트리 구조와 함수의 실행 방식.
  - 새로운 내장 함수 추가 및 확장 방법.

#### 7. **`optimizer/`**
- **설명**: 쿼리 최적화와 관련된 코드가 포함되어 있습니다. 쿼리 계획 수립, 비용 추정, 인덱스 선택 등의 최적화 로직이 구현되어 있습니다.
- **주요 파일**:
  - `optimizer.cc`: 쿼리 최적화의 기본 로직.
  - `opt_range.cc`: 인덱스 범위 스캔 최적화.
  - `opt_trace.cc`: 최적화 과정의 트레이스 로직.
- **학습 포인트**:
  - 쿼리 최적화기 동작 원리와 계획 수립 과정.
  - 쿼리 최적화 힌트 사용 및 성능 분석.

#### 8. **`partition/`**
- **설명**: 파티션 테이블 관련 코드가 포함되어 있습니다. MySQL의 파티션 테이블 처리 및 관리 로직이 구현되어 있습니다.
- **주요 파일**:
  - `partition_info.cc`: 파티션 정보 저장 및 관리.
  - `partition_handler.cc`: 파티션 테이블 핸들러 구현.
- **학습 포인트**:
  - 파티션 테이블 구조와 파티션 키 관리.
  - 파티션 테이블 쿼리의 최적화 및 처리.

#### 9. **`repl/`**
- **설명**: MySQL의 복제 관련 코드가 포함되어 있습니다. 복제 관련 기능과 마스터-슬레이브 통신, 로그 관리 등이 구현되어 있습니다.
- **주요 파일**:
  - `rpl_slave.cc`: 슬레이브 서버의 복제 처리 로직.
  - `rpl_master.cc`: 마스터 서버의 복제 처리 로직.
  - `rpl_mi.cc`: 마스터 정보 관리.
- **학습 포인트**:
  - MySQL의 복제 메커니즘 및 트랜잭션 전파 방식.
  - 복제 설정 및 문제 해결 방법.

#### 10. **`rpl_log/`**
- **설명**: 복제 로그 관리와 관련된 코드가 포함되어 있습니다. 복제 로그의 생성 및 파싱, 복제 로그 이벤트 관리 등이 포함됩니다.
- **주요 파일**:
  - `rpl_log_event.cc`: 복제 로그 이벤트 처리.
  - `rpl_record.cc`: 복제 로그 레코드 관리.
- **학습 포인트**:
  - 복제 로그의 구조와 이벤트 타입.
  - 복제 로그의 처리 및 이벤트 관리.

#### 11. **`sql_yacc.yy`**
- **설명**: MySQL의 SQL 파서를 정의하는 Yacc 파일입니다. SQL 문법 규칙과 파싱 로직이 정의되어 있으며, 이를 통해 SQL 명령어를 파싱 트리로 변환합니다.
- **학습 포인트**:
  - SQL 문법과 파서의 동작 원리.
  - 새로운 SQL 문법 추가 및 파서 확장 방법.

#### 12. **`table/`**
- **설명**: 테이블 관리와 관련된 코드가 포함되어 있습니다. 테이블의 생성, 삭제, 수정 등 테이블 관리 로직이 구현되어 있습니다.
- **주요 파일**:
  - `table.cc`: 테이블 메타데이터 관리.
  - `table_share.cc`: 테이블 공유 정보 관리.
  - `table_open_cache.cc`: 테이블 오픈 캐시 관리.
- **학습 포인트**:
  - 테이블 메타데이터 관리 및 캐싱 로직.
  - 테이블 생성, 삭제, 변경 등의 관리 작업.

#### 13. **`transaction/`**
- **설명**: 트랜잭션 관리와 관련된 코드가 포함되어 있습니다. 트랜잭션 시작, 커밋, 롤백 및 트랜잭션 격리 수준 관련 로직이 구현되어 있습니다.
- **주요 파일**:
  - `transaction.cc`: 트랜잭션 관리 기본 로직.
  - `transaction_info.cc`: 트랜잭션 정보 저장 및 관리.
- **학습 포인트**:
  - 트랜잭션 관리 및 격리 수준 이해.
  - 트랜잭션 로그 관리 및 동시성 제어.

### 학습 가이드라인

1. **기본 아키텍처 이해**: `mysqld.cc`와 `sql_class.cc` 등을 분석하여 MySQL 서버의 기본 구조와 초기화 과정을 이해합니다.
2. **쿼리 처리 과정 파악**: `sql_parse.cc`와 `sql_executor.cc`를 통해 SQL 문장이 서버에서 어떻게 파싱되고 실행되는지 학습합니다.
3. **스토리지 엔진 인터페이스 이해**: `handler/` 디렉토리와 스토리지 엔진 인터페이스 구현을 분석하여 MySQL이 다양한 스토리지 엔진과 상호작용하는 방식을 이해합니다.
4. **쿼리 최적화 분석**: `optimizer/` 디렉토리의 쿼리 최적화 관련 코드를 분석하여 쿼리 실행 계획이 어떻게 수립되고 최적화되는지 학습합니다.
5. **트랜잭션 및 복제**: `transaction/`와 `repl/` 디렉토리의 코드를 분석하여 트랜잭션 관리와 복제의 동작 원리를 이해합니다.

이러한 학습 과정을 통해 MySQL 아키텍처를 체계적으로 이해하고, MySQL 서버의 내부 동작 원리를 깊이 있게 파악할 수 있습니다.
