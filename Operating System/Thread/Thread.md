---
상위 개념: "[[Process]]"
---
# 쓰레드
> **a light-weight process**

쓰레드란 프로세스에서 내에서 실행되는 독립적인 수행 흐름이자 프로세스에서 PC를 비롯한 context와 stack 영역만 분리되어 수행될 수 있는 작업 단위입니다. Context(PC, Register 집합)와 stack만 분리되어 수행되기 때문에 Data Section과 Text Section 등의 정보는 프로세스와 공유하게 됩니다.

![[Pasted image 20230921221308.png]]
위 그림은 단일 쓰레드 프로세스 모델과 멀티 쓰레드 프로세스 모델의 차이를 보여줍니다.
싱글 쓰레드 프로세스 모델에서는 하나의 프로세스에서는 하나의 수행 흐름만 갖습니다. 이 예시는 위에서 쭉 설명한 프로세스와 동일합니다. 반면 멀티쓰레드 프로세스 모델에서는 하나의 프로세스가 여러개의 쓰레드를 갖습니다. 각각의 쓰레드는 **Thread Control Block**을 갖고 있어서, 프로세스와 별개로 보유하고 있는 Context와 Stack의 정보를 저장합니다. 이를 통해 하나의 프로세스가 동작할 때 그 내부적으로 여러개의 쓰레드들이 동시적으로 CPU를 점유하면서, 여러 동작이 동시에 수행될 수 있습니다. 이는 줌이라는 하나의 프로그램에서 실시간 화상 통신과 채팅을 동시에 할 수 있는 기반이 되며 다중 코어 시스템에서 처리 능력을 향상시키도록 설계될 수 있습니다.
![[Pasted image 20230921221338.png]]
쓰레드가 CPU를 점유하는 동작은 프로세스가 CPU를 점유하는 동작과 거의 유사하지만 (TCB에도 PCB와 동일하게 State가 존재하며 이러한 쓰레드 메타데이터를 통해 프로세서를 순차적으로 점유하게 됩니다), 프로세스 전환에서는 PCB의 정보를 활용하고 쓰레드의 전환에서는 TCB의 정보를 활용하는데에서 차이가 있습니다. 또한 User Level Thread의 경우 별도의 OS의 도움 없이 쓰레드를 전환하기도 하는데, 이는 나중에 살펴보도록 하겠습니다.
## 쓰레드 사용의 장점
쓰레드의 사용은 다음과 같은 장점을 갖습니다.
![[Pasted image 20230921221353.png]]
쓰레드의 사용은 특히 Server - Client 구조의 프로그램에서 빛을 발합니다. 일반적으로 서버 프로그램은 클라이언트의 요청이 오기를 기다리고, 요청이 들어온 뒤 그 요청을 처리하는 방식으로 작동합니다. 단일 쓰레드 환경에서 만약 한 클라이언트의 요청을 처리하는 도중에 다른 클라이언트로부터 요청이 오는 경우엔 기존의 요청을 다 처리한 후에야 새로 들어온 요청을 처리할 수 있을 것입니다. 반면 멀티 쓰레드 환경에서는 클라이언트의 요청을 받으면 새로운 쓰레드를 만들어 이를 처리해줄 것을 위임하고, 해당 쓰레드는 다시 다른 사용자의 요청을 받기를 기다립니다. 이 각각의 쓰레드가 병렬적으로 수행되는 경우 전체적인 시스템의 **응답시간이 크게 개선**될 것입니다.
이러한 작업은 사실 별개의 프로세스를 만들어도 해결되는 부분입니다. 클라이언트의 요청만을 받는 프로세스를 만들고, 요청이 들어오는 경우 새로운 프로세스를 만들어 요청을 처리할 것을 위임하면 됩니다. 하지만 이러한 상황에서 쓰레드는 프로세스보다 더 많은 장점을 제공합니다.

쓰레드는 프로세스와 일부 데이터를 공유하기 때문에 쓰레드 하나는 프로세스 하나보다 훨씬 가볍습니다. 따라서 생성과 삭제 등의 작업이 프로세스보다 훨씬 저비용으로 가능하기 때문에 생성과 삭제가 빈번한 경우에 훨씬 유리합니다. 또한 Context Switch 발생 시에도 교체해야할 데이터가 적어 훨씬 빠르게 수행할 수 있습니다.

또한 데이터를 공유하기 때문에 불필요한 데이터 공유 로직을 거치지 않아도 됩니다. 프로세스의 경우 서로의 메모리 영역이 분되어 있어서 데이터를 공유하기 위해서는 [복잡한 과정](../Process/IPC.md)*Interprocess Communication*을 거쳐야 합니다.

### 참조
[[ULT vs KLT]]
[[쓰레드 연관관계 모델]]
[[User Mode와 Kernel Mode]]
